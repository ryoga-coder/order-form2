
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>注文一覧（店員用）</title>
  <style>
    body { font-family: sans-serif; padding: 1rem; }
    h1 { text-align: center; }
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th, td { border: 1px solid #ccc; padding: 0.5rem; text-align: left; }
    th { background: #eee; }
    input[type="date"] { margin-right: 0.5rem; }
    @media (max-width: 600px) {
      table, thead, tbody, th, td, tr { display: block; }
      th { position: absolute; top: -9999px; left: -9999px; }
      td { border: none; position: relative; padding-left: 50%; }
      td::before {
        position: absolute;
        top: 0;
        left: 0;
        width: 45%;
        padding-left: 0.5rem;
        font-weight: bold;
        white-space: nowrap;
      }
      td:nth-of-type(1)::before { content: "日時"; }
      td:nth-of-type(2)::before { content: "商品名"; }
      td:nth-of-type(3)::before { content: "数量"; }
      td:nth-of-type(4)::before { content: "金額"; }
    }
  </style>
</head>
<body>
  <h1>注文一覧（店員用）</h1>
  <label for="datePicker">日付で絞り込み:</label>
  <input type="date" id="datePicker" />
  <button onclick="loadData()">更新</button>
  <table id="orderTable">
    <thead>
      <tr><th>日時</th><th>商品名</th><th>数量</th><th>金額</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const CSV_URL = "https://docs.google.com/spreadsheets/d/1mYc4Dzjmzc07lDHZDLCPLi_nUrIkEvMuoAmB65LHIX0/gviz/tq?tqx=out:csv";

    function parseCSV(text) {
      return text.trim().split("\n").slice(1).map(row => row.split(","));
    }

    function clean(value) {
      return value.replace(/^"+|"+$/g, "");
    }

    function loadData() {
      fetch(CSV_URL)
        .then(res => res.text())
        .then(csv => {
          const data = parseCSV(csv);
          const tbody = document.querySelector("#orderTable tbody");
          const selectedDate = document.getElementById("datePicker").value;
          tbody.innerHTML = "";
          data.forEach(row => {
            const datetime = clean(row[0]);
            const item = clean(row[1]);
            const qty = clean(row[2]);
            const total = clean(row[3]);
            const dateOnly = datetime.split(" ")[0];
            if (!selectedDate || selectedDate === dateOnly) {
              const tr = document.createElement("tr");
              tr.innerHTML = `<td>${datetime}</td><td>${item}</td><td>${qty}</td><td>¥${Number(total).toLocaleString()}</td>`;
              tbody.appendChild(tr);
            }
          });
        });
    }

    loadData();
  </script>
</body>
</html>
